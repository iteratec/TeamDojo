<!-- 
SPDX-FileCopyrightText: the TeamDojo authors

SPDX-License-Identifier: Apache-2.0
-->
# ADR-0005: Move Teamscore calculation to the backend

<!--
  Use one of the ADR status parameter based on status
  Please add a cross-reference link to the new ADR on 'superseded' ADR.
  e.g.: [ADR superseded by](ADR-NNNN.md)
-->
| <!-- -->       | <!-- -->                                                                             |
|----------------|--------------------------------------------------------------------------------------|
| **Status**:    | PROPOSED |
| **Date**:      | 2022-10-25                                                                          |
| **Author(s)**: | Amar Bolkan <amar.bolkan@iteratec.com                         |



## Context

Teamdojo has a feature, which tracks a score for each team. Calculation of this score is currently done client side. 
Depending on the amount of skills and teams the scores can be incorrect. This happens due to pagination and the client not checking if all records were queried.



## Decision

Move team score calculations to the backend and create an Api, which 
the client can query.

Proposed API:

`/api/team-score/:teamId` : Accepts GET requests and returns the current score for the queried team. 

Files to be added to the backend:
- `CustomTeamscoreResource`
- `CustomTeamScoreService`

Files to be changed in the frontend:
- `src/main/webapp/app/custom/overview/teams/overview-teams.component.ts`
- `src/main/webapp/app/custom/teams/teams-status/teams-status.component.ts`

Files to be deleted:
- `src/main/webapp/app/custom/helper/team-score-calculation.ts`

<!--
Relevant files for score calculation:
- CompletionCheck `src/main/webapp/app/custom/helper/completion-check.ts`
- RelevanceCheck `src/main/webapp/app/custom/helper/relevance-check.ts`
- TeamScoreCalculation `src/main/webapp/app/custom/helper/team-score-calculation.ts`
- SkillStatusUtils `src/main/webapp/app/custom/helper/skill-status.ts`

mirror these classes in the backend
Variable used in TeamScore calculation: team (containing all achieved skills), all available skills, and all available badges
-->

## Consequences

This change will shift the computational load onto the server and provides a clear and easy way for the client to
query scores for each individual team. In turn new classes are added to the backend. The client code also needs to be adapted to use this new Api.

Leads to code duplication as `RelevanceCheck` and `CompletionCheck` are also used in different parts of the frontend.


