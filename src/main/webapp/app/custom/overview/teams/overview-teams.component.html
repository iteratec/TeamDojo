<div class="overviews-teams">
  <div>
    <h4 jhiTranslate="teamDojoApp.overview.teams.title"></h4>
  </div>

  <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
    <!-- This is the tree node template for leaf nodes -->
    <!-- There is inline padding applied to this node using styles.
      This padding value depends on the mat-icon-button width. -->
    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
      <button mat-icon-button matTreeNodeToggle (click)="teamGroupSelected(node.name)">
        {{ node.name }}
      </button>
    </mat-tree-node>
    <!-- This is the tree node template for expandable nodes -->
    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
      <div class="mat-tree-node">
        <button mat-icon-button matTreeNodeToggle (click)="teamGroupSelected(node.name)">
          <fa-icon *ngIf="treeControl.isExpanded(node); else closed" icon="caret-down"></fa-icon>

          <ng-template #closed>
            <fa-icon icon="caret-right"></fa-icon>
          </ng-template>

          {{ node.name }}
        </button>
      </div>
      <!-- There is inline padding applied to this div using styles.
          This padding value depends on the mat-icon-button width.  -->
      <div [class.example-tree-invisible]="!treeControl.isExpanded(node)" role="group">
        <ng-container matTreeNodeOutlet></ng-container>
      </div>
    </mat-nested-tree-node>
  </mat-tree>

  <div class="additional-functions d-flex align-items-center"></div>
  <div class="team-list" data-simplebar>
    <div class="team-list-header d-flex justify-content-between mb-3">
      <div class="team-list-header-title d-flex align-items-end">
        <span jhiTranslate="teamDojoApp.overview.total-score.title"></span>
      </div>
      <div class="team-list-header-scores d-flex flex-row ms-auto justify-content-between align-items-end">
        <div class="score d-flex flex-column align-items-center">
          <img src="../../../../content/custom/images/coin_black.png" />
          <span>{{ calcTotalTeamScore() }}</span>
        </div>
        <div class="score d-flex flex-column align-items-center">
          <img src="../../../../content/custom/images/belt_black.png" />
          <span>{{ calcTotalCompletedLevel() }}/{{ getTotalLevelBase() }}</span>
        </div>
        <div class="score d-flex flex-column align-items-center">
          <img src="../../../../content/custom/images/badge_black.png" />
          <span>{{ calcTotalCompletedBadges() }}</span>
        </div>
      </div>
    </div>
    <div class="team-list-body">
      <div
        class="team-list-body-item d-flex align-items-center justify-content-between mb-1"
        *ngFor="let teamScore of teamScores | teamGroupFilter: this.selectedTeamGroup; index as i"
        [ngClass]="{
          irrelevant: showAsIrrelevant(teamScore.team),
          complete: showAsComplete(teamScore.team),
          incomplete: showAsIncomplete(teamScore.team)
        }"
      >
        <div class="team-info d-flex align-items-center">
          <div class="team-rank">{{ i + 1 }}</div>
          <div class="me-2">
            <jhi-team-image [team]="teamScore.team" imageSize="small"></jhi-team-image>
          </div>
          <div class="team-name">
            <a href="#" [routerLink]="['/teams', teamScore.team?.shortTitle]" queryParamsHandling="preserve">{{
              teamScore.team?.title + ' (' + teamScore.team?.group?.title + ')'
            }}</a>
            <span *ngIf="teamScore.team?.official" class="official-badge">{{ 'teamDojoApp.overview.teams.official' | translate }}</span>
            <div *ngIf="showExpirationDate(teamScore.team)" class="expiration-date">
              {{ 'teamDojoApp.overview.teams.expirationDate' | translate }}
              {{ teamScore.team?.expirationDate?.toDate() | date: 'medium' }}
            </div>
          </div>
        </div>
        <div class="team-scores d-flex flex-row ms-auto justify-content-between">
          <span class="score">{{ teamScore.score }}</span>
          <span class="score">{{ calcCompletedLevel(teamScore.team) }}/{{ calcLevelBase(teamScore.team) }}</span>
          <span class="score">{{ calcCompletedBadges(teamScore.team) }}</span>
        </div>
        <div class="team-status" [ngClass]="{ complete: showAsComplete(teamScore.team) }">
          <fa-icon *ngIf="showAsComplete(teamScore.team)" icon="check" class="fa-inverse"></fa-icon>
        </div>
      </div>
    </div>
  </div>
</div>
